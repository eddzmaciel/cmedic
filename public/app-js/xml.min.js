!function(t,a){function e(t){return!!(""===t||t&&t.charCodeAt&&t.substr)}function o(t){return p?p(t):"[object Array]"===g.call(t)}function n(t){return t&&"[object Object]"===g.call(t)}function i(t,a){var e;t=t||{},a=a||{};for(e in a)a.hasOwnProperty(e)&&null==t[e]&&(t[e]=a[e]);return t}function s(t,a,e){var o,n,i=[];if(!t)return i;if(l&&t.map===l)return t.map(a,e);for(o=0,n=t.length;o<n;o++)i[o]=a.call(e,t[o],o,t);return i}function r(t,a){return t=Math.round(Math.abs(t)),isNaN(t)?a:t}function c(t){var a=d.settings.currency.format;return"function"==typeof t&&(t=t()),e(t)&&t.match("%v")?{pos:t,neg:t.replace("-","").replace("%v","-%v"),zero:t}:t&&t.pos&&t.pos.match("%v")?t:e(a)?d.settings.currency.format={pos:a,neg:a.replace("%v","-%v"),zero:a}:a}var d={};d.version="0.4.1",d.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var l=Array.prototype.map,p=Array.isArray,g=Object.prototype.toString,_=d.unformat=d.parse=function(t,a){if(o(t))return s(t,function(t){return _(t,a)});if(t=t||0,"number"==typeof t)return t;a=a||d.settings.number.decimal;var e=new RegExp("[^0-9-"+a+"]",["g"]),n=parseFloat((""+t).replace(/\((.*)\)/,"-$1").replace(e,"").replace(a,"."));return isNaN(n)?0:n},u=d.toFixed=function(t,a){a=r(a,d.settings.number.precision);var e=Math.pow(10,a);return(Math.round(d.unformat(t)*e)/e).toFixed(a)},m=d.formatNumber=d.format=function(t,a,e,c){if(o(t))return s(t,function(t){return m(t,a,e,c)});t=_(t);var l=i(n(a)?a:{precision:a,thousand:e,decimal:c},d.settings.number),p=r(l.precision),g=t<0?"-":"",b=parseInt(u(Math.abs(t||0),p),10)+"",f=b.length>3?b.length%3:0;return g+(f?b.substr(0,f)+l.thousand:"")+b.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+l.thousand)+(p?l.decimal+u(Math.abs(t),p).split(".")[1]:"")},b=d.formatMoney=function(t,a,e,l,p,g){if(o(t))return s(t,function(t){return b(t,a,e,l,p,g)});t=_(t);var u=i(n(a)?a:{symbol:a,precision:e,thousand:l,decimal:p,format:g},d.settings.currency),f=c(u.format),v=t>0?f.pos:t<0?f.neg:f.zero;return v.replace("%s",u.symbol).replace("%v",m(Math.abs(t),r(u.precision),u.thousand,u.decimal))};d.formatColumn=function(t,a,l,p,g,u){if(!t)return[];var b=i(n(a)?a:{symbol:a,precision:l,thousand:p,decimal:g,format:u},d.settings.currency),f=c(b.format),v=f.pos.indexOf("%s")<f.pos.indexOf("%v"),$=0,h=s(t,function(t,a){if(o(t))return d.formatColumn(t,b);t=_(t);var e=t>0?f.pos:t<0?f.neg:f.zero,n=e.replace("%s",b.symbol).replace("%v",m(Math.abs(t),r(b.precision),b.thousand,b.decimal));return n.length>$&&($=n.length),n});return s(h,function(t,a){return e(t)&&t.length<$?v?t.replace(b.symbol,b.symbol+new Array($-t.length+1).join(" ")):new Array($-t.length+1).join(" ")+t:t})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=d),exports.accounting=d):"function"==typeof define&&define.amd?define([],function(){return d}):(d.noConflict=function(e){return function(){return t.accounting=e,d.noConflict=a,d}}(t.accounting),t.accounting=d)}(this),_g.dao={getValidParametrizacion:function(){$.ajax({url:"/api_cont/validar_parametrizacion/"+$("#id_empresa_data").val(),type:"GET",dataType:"json"}).done(function(t){0!=t.impuestos||0!=t.ingresos||0!=t.egresos||0!=t.ncc||0!=t.ncf||0!=t.nomina?$("#btnProcesar").show("slow"):$("#btnProcesar").hide()})},getXML:function(){$.ajax({url:"/api_cont/archivos_xml",type:"GET",dataType:"json",success:function(t){var a=t,e=$("#tblXML"),o=[{aTargets:[0],bVisible:!1,mData:"id"},{aTargets:[1],mData:"uuid"},{aTargets:[2],mData:"estatus_sat"},{aTargets:[3],mData:"poliza"},{aTargets:[4],mData:"id_entidad"},{aTargets:[5],mData:"poliza"},{aTargets:[6],mData:"poliza"},{aTargets:[7],mData:"total"},{aTargets:[8],mData:"f_timbrado"},{aTargets:[9],mData:"f_importado"},{aTargets:[10],mData:"fecha_cancelado"},{aTargets:[11],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-success" onclick="_g.dao.getModalXML('+t.id+')"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getModificarDatos('+t.id+')"><i class="glyphicon glyphicon-pencil"></i></a>&nbsp;<a class="btn btn-sm btn-danger" onclick="_g.dao.getEliminarDatos('+t.id+')"><i class="glyphicon glyphicon-trash"></i></a>&nbsp; '}}];_gen.setTableNE(e,o,a)}})},getXMLAvanzada:function(){var t={id_empresa:$("#id_empresa").val(),id_sucursal:$("#id_sucursal").val(),id_cc:$("#id_centro_costos").val(),id_scc:$("#select_scc").val(),desde:$("#desde").val(),hasta:$("#hasta").val(),tipo_xml:$("#id_tipo_xml").val()};$.ajax({data:t,url:"/api_cont/archivos_xml_avanzada",type:"POST",dataType:"json",success:function(t){if(0!=t.length){var a=t,e=$("#tblXML");$.each(t,function(a){"Ingreso"==t[a].origen&&(t[a].label_rfc=t[a].rfc_cliente,t[a].label_nombre=t[a].nombre_cliente),"Egreso"==t[a].origen&&(t[a].label_rfc=t[a].rfc_prov,t[a].label_nombre=t[a].nombre_prov),"NCC"==t[a].origen&&(t[a].label_rfc=t[a].rfc_ncc,t[a].label_nombre=t[a].nombre_ncc),"NCF"==t[a].origen&&(t[a].label_rfc=t[a].rfc_ncf,t[a].label_nombre=t[a].nombre_ncf),"Nomina"==t[a].origen&&(t[a].label_rfc=t[a].rfc_nomina,t[a].label_nombre=t[a].nombre_nomina)});var o=[{aTargets:[0],mData:null,mRender:function(t){return 0!=t.debe_ajuste_pesos?"<strong>Ajuste Cargado por: "+accounting.formatMoney(t.debe_ajuste_pesos)+"</strong>":0!=t.haber_ajuste_pesos?"<strong>Ajuste Abonado por:"+accounting.formatMoney(t.haber_ajuste_pesos)+"</strong>":0==t.debe_ajuste_pesos||0==$haber_ajuste_pesos?"":void 0}},{aTargets:[1],mData:"uuid"},{aTargets:[2],mData:"estatus_sat"},{aTargets:[3],mData:"poliza"},{aTargets:[4],mData:"label_nombre"},{aTargets:[5],mData:"label_rfc"},{aTargets:[6],mData:"poliza"},{aTargets:[7],mData:null,mRender:function(t){return"USD"==t.moneda||"usd"==t.moneda||"DLS"==t.moneda||"dls"==t.moneda?"<strong>"+accounting.formatMoney(t.total_plz*parseFloat(t.tipo_cambio))+"</strong>":accounting.formatMoney(t.total_plz)}},{aTargets:[8],mData:"f_timbrado"},{aTargets:[9],mData:"f_importado"},{aTargets:[10],mData:"fecha_cancelado"},{aTargets:[11],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-success" onclick="_g.dao.getModalXML('+t.id+')"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getModificarDatos('+t.id+')"><i class="glyphicon glyphicon-pencil"></i></a>&nbsp;<a class="btn btn-sm btn-danger" onclick="_g.dao.getEliminarDatos('+t.id+')"><i class="glyphicon glyphicon-trash"></i></a><a class="btn btn-sm btn-primary" onclick="_g.dao.getModalPolizaConceptos('+t.id+')"><i class="glyphicon glyphicon-file"></i></a>&nbsp;'}}];_gen.setTableNE(e,o,a),$("#wdtTable").show()}else _gen.notificacion_min("Error","No se encontraron registros con esos filtros",4)}})},getEliminarDatos:function(t){$.ajax({url:"/api_cont/archivos_xml/"+t,type:"DELETE",dataType:"json"}).done(function(t){_g.dao.getXMLAvanzada(),_gen.notificacion_min("&Eacute;xito","La operaci&oacute;n se realiz&oacute; exitosamente",1)}).fail(function(t){_gen.notificacion_min("Aviso","Al parecer se presento un problema al momento de eliminar, intente de nuevo.",4)})},getModalXML:function(t){$.ajax({url:"/api_cont/archivos_xml/"+t,type:"GET",dataType:"json",success:function(t){$("#infoXMLModal").modal(),$("#mdl_uuid, #mdl_data1, #mdl_data2, #mdl_data3").html(""),$("#mdl_uuid").append(t.uuid),$("#mdl_data1").append("<tr><td><strong>Empresa : </strong></td><td>"+t.id_empresa+"</td></tr><tr><td><strong>Sucursal : </strong></td><td>"+t.id_sucursal+"</td></tr><tr><td><strong>Centro de costos : </strong></td><td>"+t.id_cc+"</td></tr><tr><td><strong>Sub Centro de costos : </strong></td><td>"+t.id_scc+"</td></tr><tr><td><strong>Condiciones de pago : </strong></td><td>"+t.condiciones_de_pago+"</td></tr><tr><td><strong>Descuento : </strong></td><td>"+t.descuento+"</td></tr><tr><td><strong>Fecha : </strong></td><td>"+t.fecha+"</td></tr><tr><td><strong>Folio : </strong></td><td>"+t.folio+"</td></tr>"),$("#mdl_data2").append("<tr><td><strong>Forma de pago : </strong></td><td>"+t.forma_de_pago+"</td></tr><tr><td><strong>Metodo de pago : </strong></td><td>"+t.metodo_de_pago+"</td></tr><tr><td><strong>Moneda : </strong></td><td>"+t.moneda+"</td></tr><tr><td><strong>Serie : </strong></td><td>"+t.serie+"</td></tr><tr><td><strong>Subtotal : </strong></td><td>"+t.subTotal+"</td></tr><tr><td><strong>Tipo de cambio : </strong></td><td>"+t.tipo_cambio+"</td></tr><tr><td><strong>Tipo de comprobante : </strong></td><td>"+t.tipo_comprobante+"</td></tr><tr><td><strong>Total : </strong></td><td>"+t.total+"</td></tr>"),$("#mdl_data3").append("<tr><td><strong>Poliza : </strong></td><td>"+t.poliza+"</td></tr><tr><td><strong>Fecha timbrado : </strong></td><td>"+t.fecha_timbrado+"</td></tr><tr><td><strong>Fecha cancelado : </strong></td><td>"+t.fecha_cancelado+"</td></tr><tr><td><strong>Estatus : </strong></td><td>"+t.estatus+"</td></tr>")}})},getModalPoliza:function(t){$.ajax({url:"/api_cont/poliza_diario/"+t,type:"GET",dataType:"json",success:function(t){$("#infoPolizaModal").modal(),$("#plz_data, #plz_data1, #plz_data2").html(""),0==t.xml.id_sucursal&&(t.xml.id_sucursal="NA"),0==t.xml.id_cc&&(t.xml.id_cc="NA"),0==t.xml.id_scc&&(t.xml.id_scc="NA"),$("#plz_data").append('<tr><td><strong>Empresa :</strong></td><td colspan="3">'+t.xml.nombre+'</td><td><strong>RFC :</strong></td><td colspan="3">'+t.xml.rfc+"</td></tr><tr><td><strong>Folio :</strong></td><td>"+t.xml.poliza+"</td><td><strong>Fecha :</strong></td><td>"+t.xml.fecha+"</td><td><strong>Moneda :</strong></td><td>"+t.xml.moneda+"</td><td><strong>TC :</strong></td><td>"+t.xml.tipo_comprobante+'</td></tr><tr><td><strong>Observaciones :</strong></td><td colspan="7"></td></tr><tr><td><strong>Sucursal :</strong></td><td colspan="2">'+t.xml.id_sucursal+'</td><td><strong>CCostos :</strong></td><td colspan="2">'+t.xml.id_cc+'</td><td><strong>SCCostos :</strong></td><td colspan="1">'+t.xml.id_scc+'</td></tr><tr><td><strong>Origen de Poliza :</strong></td><td colspan="3">'+t.xml.origen+'</td><td><strong>UUID :</strong></td><td colspan="3">'+t.xml.uuid+"</td></tr>"),$("#plz_data1").append("<tr><td></td><td># Cuenta</td><td> Descripción</td><td> Debe</td><td> Haber</td></tr>");var a="",e="",o="",n="",i="",s="",r="",c="",d="",l="",p="";$.each(t.conceptos_pd,function(o){"TOTAL DEL XML"==t.conceptos_pd[o].concepto&&"Nacional"==t.conceptos_pd[o].tipo_ne&&"XEXX010101000"!=t.xml.rfc&&(a="<tr><td><strong>Total del XML : </strong></td><td>"+t.conceptos_pd[o].codigo_cuenta_contable+"</td><td>"+t.conceptos_pd[o].cuenta_contable+"</td>","Ingreso"==t.conceptos_pd[o].origen||"NCF"==t.conceptos_pd[o].origen?(e="<td>"+t.xml.total+"</td><td></td></tr>",c="<tr><td><strong>SUBTOTAL : </strong></td><td></td><td></td><td></td><td>"+t.xml.subTotal+"</td></tr>",d="<tr><td><strong>IMPUESTOS TRASLADOS : </strong></td><td></td><td></td><td></td><td>"+t.xml.impuesto_trasladados+"</td></tr>",l="<tr><td><strong>IMPUESTOS RETENIDOS : </strong></td><td></td><td></td><td>"+t.xml.impuestos_retenidos+"</td><td></td></tr>",p="<tr><td><strong>IMPUESTOS LOCALES : </strong></td><td></td><td></td><td>"+t.xml.impuestos_locales+"</td><td></td></tr>"):(e="<td></td><td>"+t.xml.total+"</td></tr>",c="<tr><td><strong>SUBTOTAL : </strong></td><td></td><td></td><td>"+t.xml.subTotal+"</td><td></td></tr>",d="<tr><td><strong>IMPUESTOS TRASLADOS : </strong></td><td></td><td></td><td>"+t.xml.impuesto_trasladados+"</td><td></td></tr>",l="<tr><td><strong>IMPUESTOS RETENIDOS : </strong></td><td></td><td></td><td></td><td>"+t.xml.impuestos_retenidos+"</td></tr>",p="<tr><td><strong>IMPUESTOS LOCALES : </strong></td><td></td><td></td><td>"+t.xml.impuestos_locales+"</td><td></td></tr>")),"DESCUENTO"==t.conceptos_pd[o].concepto&&"Nacional"==t.conceptos_pd[o].tipo_ne&&"XEXX010101000"!=t.xml.rfc&&(i="<tr><td><strong>DESCUENTO : </strong></td><td>"+t.conceptos_pd[o].codigo_cuenta_contable+"</td><td>"+t.conceptos_pd[o].cuenta_contable+"</td>",s="Ingreso"==t.conceptos_pd[o].origen||"NCF"==t.conceptos_pd[o].origen?"<td>"+t.xml.descuento+"</td><td></td></tr>":"<td></td><td>"+t.xml.descuento+"</td></tr>"),"AJUSTE A PESOS"==t.conceptos_pd[o].concepto&&(r="<tr><td><strong>AJUSTE A PESOS : </strong></td><td>"+t.conceptos_pd[o].codigo_cuenta_contable+"</td><td>"+t.conceptos_pd[o].cuenta_contable+"</td><td></td><td></td></tr>")}),$("#plz_data1").append(a.concat(e)),0!=t.xml.impuesto_trasladados&&$("#plz_data1").append(d),0!=t.xml.impuestos_retenidos&&$("#plz_data1").append(l),0!=t.xml.impuestos_locales&&$("#plz_data1").append(p),$("#plz_data1").append(i.concat(s)),$("#plz_data1").append(r),$("#plz_data1").append(c),"Ingreso"==t.xml.origen||"NCF"==t.xml.origen?(o=parseFloat(t.xml.total)+parseFloat(t.xml.impuestos_retenidos)+parseFloat(t.xml.descuento),n=parseFloat(t.xml.impuesto_trasladados)+parseFloat(t.xml.impuestos_locales)+parseFloat(t.xml.subTotal)):(o=parseFloat(t.xml.impuesto_trasladados)+parseFloat(t.xml.impuestos_locales)+parseFloat(t.xml.subTotal),n=parseFloat(t.xml.total)+parseFloat(t.xml.impuestos_retenidos)+parseFloat(t.xml.descuento)),$("#plz_data2").append("<tr><td><strong>Total Debe : </strong></td><td>"+o+"</td></tr><tr><td><strong>Total Haber : </strong></td><td>"+n+"</td></tr>")}})},getModalPolizaConceptos:function(t){$.ajax({url:"/api_cont/poliza_diario_conceptos/"+t,type:"GET",dataType:"json",success:function(t){$("#infoPolizaModal").modal(),$("#plz_data, #plz_data1, #plz_data2").html(""),0==t.xml.id_sucursal&&(t.xml.id_sucursal="NA"),0==t.xml.id_cc&&(t.xml.id_cc="NA"),0==t.xml.id_scc&&(t.xml.id_scc="NA"),$("#plz_data").append('<tr><td><strong>Empresa :</strong></td><td colspan="3">'+t.xml.nombre+'</td><td><strong>RFC :</strong></td><td colspan="3">'+t.xml.rfc+"</td></tr><tr><td><strong>Folio :</strong></td><td>"+t.xml.poliza+"</td><td><strong>Fecha :</strong></td><td>"+t.xml.fecha+"</td><td><strong>Moneda :</strong></td><td>"+t.xml.moneda+"</td><td><strong>TC :</strong></td><td>"+t.xml.tipo_cambio+'</td></tr><tr><td><strong>Observaciones :</strong></td><td colspan="7"></td></tr><tr><td><strong>Sucursal :</strong></td><td colspan="2">'+t.xml.id_sucursal+'</td><td><strong>CCostos :</strong></td><td colspan="2">'+t.xml.id_cc+'</td><td><strong>SCCostos :</strong></td><td colspan="1">'+t.xml.id_scc+'</td></tr><tr><td><strong>Origen de Poliza :</strong></td><td colspan="3">'+t.xml.origen+'</td><td><strong>UUID :</strong></td><td colspan="3">'+t.xml.uuid+"</td></tr>"),$("#plz_data1").append("<tr><td><strong># Cuenta</strong></td><td><strong> Descripción </strong></td><td><strong>Concepto</strong></td><td><strong> Debe </strong></td><td><strong> Haber </strong></td></tr>");var a=0;if("USD"==t.xml.moneda||"dlls"==t.xml.moneda||"dolar"==t.xml.moneda||"dolar americano"==t.xml.moneda||"dolar estadounidence"==t.xml.moneda||"usd"==t.xml.moneda)var a=t.xml.tipo_cambio;else var a=1;"Nomina"==t.xml.origen&&(0==t.nomina_conceptos.length?$("#plz_data1").append('<tr><td colspan="5"><h1><span class="label label-danger">Ups! Hay que parametrizar los datos</span></h1></td></tr>'):($("#plz_data1").append("<tr><td> "+t.nomina.num_cta_poliza+" </td><td> "+t.nomina.nom_cta_poliza+" </td><td></td><td> </td> <td> "+$.number(t.xml.total*parseFloat(a),2)+" </td></tr>"),$.each(t.nomina_conceptos,function(e){"Percepcion"==t.nomina_conceptos[e].tipo&&((t.nomina_conceptos[e].importe_excento<0||t.nomina_conceptos[e].importe_gravado<0)&&($imp_nom=(t.nomina_conceptos[e].importe_excento+t.nomina_conceptos[e].importe_gravado)*-1),t.nomina_conceptos[e].importe_excento>0?$imp_nom=t.nomina_conceptos[e].importe_excento:$imp_nom=t.nomina_conceptos[e].importe_gravado,$("#plz_data1").append("<tr><td>"+t.nomina_conceptos[e].no_cuenta+"</td><td>"+t.nomina_conceptos[e].nombre_cta+"</td><td>"+t.nomina_conceptos[e].concepto+"</td><td>"+$.number($imp_nom*parseFloat(a),2)+"</td> <td></td></tr>")),"Deduccion"==t.nomina_conceptos[e].tipo&&(t.nomina_conceptos[e].importe_excento>0?$imp_nom=t.nomina_conceptos[e].importe_excento:$imp_nom=t.nomina_conceptos[e].importe_gravado,$("#plz_data1").append("<tr><td>"+t.nomina_conceptos[e].no_cuenta+"</td><td>"+t.nomina_conceptos[e].nombre_cta+"</td><td>"+t.nomina_conceptos[e].concepto+"</td><td></td> <td>"+$.number($imp_nom*parseFloat(a),2)+"</td></tr>"))}),t.xml.ajuste_a_pesos>0&&$("#plz_data1").append("<tr><td>"+t.xml.ajuste_cta+"</td><td>"+t.xml.ajuste_cta_nombre+"</td><td></td>"+("Haber"==t.xml.dh_ajuste?"<td></td> <td>"+$.number(t.xml.ajuste_a_pesos*parseFloat(a),2)+"</td></tr>":"<td>"+$.number(t.xml.ajuste_a_pesos*parseFloat(a),2)+"<td></td></tr>")),$("#plz_data2").append('<tr><td colspan="6"></td><td><strong>Total Debe</strong></td><td><strong>Total Haber</strong></td></tr>'),$("#plz_data2").append('<tr><td colspan="6"></td><td>'+accounting.formatMoney(t.xml.total_plz*parseFloat(a))+"</td><td>"+accounting.formatMoney(t.xml.total_plz*parseFloat(a))+"</td></tr>"))),"Nomina"!=t.xml.origen&&(0==t.conceptos_pd.length||""==t.conceptos_pd||t.xml.cont!=t.conceptos_pd.length?$("#plz_data1").append('<tr><td colspan="5"><h1><span class = "label label-danger">Ups! Hay que parametrizar los datos</span></h1></td></tr>'):($("#plz_data1").append("<tr><td>"+t.xml.cta_total+"</td><td>"+t.xml.cta_total_nom+"</td><td></td>"+("Ingreso"==t.xml.origen||"NCF"==t.xml.origen?"<td>"+$.number(t.xml.total*parseFloat(a),2)+"</td> <td></td> </tr>":"<td></td> <td>"+$.number(t.xml.total*parseFloat(a),2)+"</td> </tr>")),t.xml.descuento>0&&$("#plz_data1").append("<tr><td> 4700505 </td><td> Desc., Dev. y Reb. S/Ventas 16%</td> <td></td>"+("Ingreso"==t.xml.origen||"NCF"==t.xml.origen?"<td>"+t.xml.descuento*parseFloat(a)+"</td> <td></td></tr>":"<td></td> <td>"+t.xml.descuento*parseFloat(a)+"</td> </tr>")),$.each(t.conceptos_pd,function(e){"Ingreso"!=t.xml.origen&&"NCF"!=t.xml.origen||(t.conceptos_pd[e].importe<0?$("#plz_data1").append("<tr><td>"+t.conceptos_pd[e].codigo+"</td><td>"+t.conceptos_pd[e].cuenta_contable+"</td><td>"+t.conceptos_pd[e].descripcion+"</td><td>"+$.number(t.conceptos_pd[e].importe*parseFloat(a),2)+"</td> <td></td></tr>"):$("#plz_data1").append("<tr><td>"+t.conceptos_pd[e].codigo+"</td><td>"+t.conceptos_pd[e].cuenta_contable+"</td><td>"+t.conceptos_pd[e].descripcion+"</td><td> </td> <td>"+$.number(t.conceptos_pd[e].importe*parseFloat(a),2)+"</td></tr>")),"Egreso"!=t.xml.origen&&"NCC"!=t.xml.origen||(t.conceptos_pd[e].importe<0?$("#plz_data1").append("<tr><td>"+t.conceptos_pd[e].codigo+"</td><td>"+t.conceptos_pd[e].cuenta_contable+"</td><td>"+t.conceptos_pd[e].descripcion+"</td><td> </td> <td>"+$.number(-1*t.conceptos_pd[e].importe*parseFloat(a),2)+"</td></tr>"):$("#plz_data1").append("<tr><td>"+t.conceptos_pd[e].codigo+"</td><td>"+t.conceptos_pd[e].cuenta_contable+"</td><td>"+t.conceptos_pd[e].descripcion+"</td><td>"+$.number(t.conceptos_pd[e].importe*parseFloat(a),2)+"</td> <td></td></tr>"))}),0==t.impuestos.length&&""==t.impuestos||$.each(t.impuestos,function(e){"Ingreso"!=t.xml.origen&&"NCF"!=t.xml.origen||("Impuesto Trasladado (IT)"!=t.impuestos[e].tipo_impuesto&&"Impuesto Local Transladado (ILT)"!=t.impuestos[e].tipo_impuesto||t.impuestos[e].importe>0&&$("#plz_data1").append("<tr><td>"+t.impuestos[e].codigo+"</td><td>"+t.impuestos[e].cuenta_contable+"</td> <td></td> <td></td> <td>"+$.number(t.impuestos[e].importe*parseFloat(a),2)+"</td></tr>"),"Impuesto Retenidos (IR)"!=t.impuestos[e].tipo_impuesto&&"Impuesto Local Retenido (ILR)"!=t.impuestos[e].tipo_impuesto||$("#plz_data1").append("<tr><td>"+t.impuestos[e].codigo+"</td><td>"+t.impuestos[e].cuenta_contable+"</td> <td></td> <td>"+$.number(t.impuestos[e].importe*parseFloat(a),2)+"</td> <td></td></tr>")),"Egreso"!=t.xml.origen&&"NCC"!=t.xml.origen||("Impuesto Trasladado (IT)"!=t.impuestos[e].tipo_impuesto&&"Impuesto Local Transladado (ILT)"!=t.impuestos[e].tipo_impuesto||t.impuestos[e].importe>0&&$("#plz_data1").append("<tr><td>"+t.impuestos[e].codigo+"</td><td>"+t.impuestos[e].cuenta_contable+"</td> <td></td> <td>"+$.number(t.impuestos[e].importe*parseFloat(a),2)+"</td> <td></td> </tr>"),"Impuesto Retenidos (IR)"!=t.impuestos[e].tipo_impuesto&&"Impuesto Local Retenido (ILR)"!=t.impuestos[e].tipo_impuesto||$("#plz_data1").append("<tr><td>"+t.impuestos[e].codigo+"</td><td>"+t.impuestos[e].cuenta_contable+"</td> <td></td> <td></td> <td>"+$.number(t.impuestos[e].importe*parseFloat(a),2)+"</td> </tr>"))}),t.xml.ajuste_a_pesos>0&&$("#plz_data1").append("<tr><td> "+t.xml.ajuste_cta+" </td><td> "+t.xml.ajuste_cta_nombre+"</td><td></td>"+("Haber"==t.xml.dh_ajuste?"<td></td><td>"+$.number(t.xml.ajuste_a_pesos*parseFloat(a),2)+" </td></tr>":"<td>"+$.number(t.xml.ajuste_a_pesos*parseFloat(a),2)+"</td> <td></td> </tr>")),$("#plz_data2").append('<tr><td colspan="4"></td><td><strong>Total Debe</strong></td><td><strong>Total Haber</strong></td></tr>'),$("#plz_data2").append('<tr><td colspan="4"></td><td>'+accounting.formatMoney(t.xml.total_plz*parseFloat(a))+"</td><td>"+accounting.formatMoney(t.xml.total_plz*parseFloat(a))+"</td></tr>")))}})},getParametrizacion:function(){0!=$("#id_empresa_data").val()?($("#WdtDropzone").hide(),$.ajax({url:"/api_cont/parametrizacion/"+$("#id_empresa_data").val(),type:"GET",dataType:"json",success:function(t){$("#contImpuestos").append(t.impuestos.length),$("#contIngresos").append(t.ingresos.length),$("#contEgresos").append(t.egresos.length),""!=t.ge.gravados_excentos&&null!=t.ge.gravados_excentos&&($("#buttonsCheckEgresos").show(),$("#buttonsCheckNCF").show()),$("#contNCC").append(t.ncc.length),$("#contNCF").append(t.ncf.length),$("#contNomina").append(t.nomina.length),_g.dao.getTablaImpuestos(t.impuestos),_g.dao.getTablaIngresos(t.ingresos),_g.dao.getTablaEgresos(t.egresos),_g.dao.getTablaNCF(t.ncf),_g.dao.getTablaNCC(t.ncc),_g.dao.getTablaNomina(t.nomina),_g.dao.getTablaXMLError()}}).done(function(){$("#cargandoInfo").hide(),$("#WdtParametrizacion").show()})):_gen.notificacion_min("Error","Seleccione una empresa porfavor",4)},getParametrizacionModificar:function(){0!=$("#id_empresa").val()?$.ajax({url:"/api_cont/parametrizacion_modificar/"+$("#id_empresa").val(),type:"GET",dataType:"json",success:function(t){$("#contImpuestos, #contIngresos, #contEgresos, #contNCC, #contNCF, #contNomina").html(""),$("#contImpuestos").append(t.impuestos.length),$("#contIngresos").append(t.ingresos.length),$("#contEgresos").append(t.egresos.length),""!=t.ge.gravados_excentos&&null!=t.ge.gravados_excentos&&($("#buttonsCheckEgresos").show(),$("#buttonsCheckNCF").show()),$("#contNCC").append(t.ncc.length),$("#contNCF").append(t.ncf.length),$("#contNomina").append(t.nomina.length),_g.dao.getTablaImpuestos(t.impuestos),_g.dao.getTablaIngresos(t.ingresos),_g.dao.getTablaEgresos(t.egresos),_g.dao.getTablaNCF(t.ncf),_g.dao.getTablaNCC(t.ncc),_g.dao.getTablaNomina(t.nomina),_g.dao.getTablaXMLError()}}).done(function(t){$("#cargandoInfo").hide(),$("#WdtParametrizacion").show()}):_gen.notificacion_min("Error","Seleccione una empresa porfavor",4)},getTablaImpuestos:function(t){var a=t,e=$("#tblImpuestos"),o=[{aTargets:[0],mData:"id_impuestos"},{aTargets:[1],mData:"tasa"},{aTargets:[2],mData:"tipo_impuesto"},{aTargets:[3],mData:"cuenta_contable"},{aTargets:[4],mData:"nombre_impuesto"},{aTargets:[5],mData:"origen"},{aTargets:[6],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-primary" onclick="_g.dao.getAsignarCuentaImpuestos('+t.id_impuestos+')"><i class="glyphicon glyphicon-floppy-saved"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getViewImpuestos('+t.id_impuestos+')"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;'}}];_gen.setTableNE(e,o,a)},getViewImpuestos:function(t){var a={id_empresa:$("#id_empresa").val(),id:t};$.ajax({url:"/api_cont/consulta/impuesto",type:"POST",data:a,dataType:"json",success:function(t){$("#contentParametrizacionModal").html(""),$("#contentParametrizacionModal").append('<div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="inf_xml_uuid"><table class="table table-bordered"><tbody><tr><td><strong>UUID :</strong></td><td id="plz_uuid">'+t.uuid+'</td></tr></tbody></table></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="inf_xml_one"><table class="table table-bordered"><tbody id="plz_data1"><tr><td><strong>Tipo Comprobante : </strong></td><td>'+t.tipo_documento+"</td></tr><tr><td><strong>Total XML : </strong></td><td>"+t.total+"</td></tr><tr><td><strong>SubTotal XML : </strong></td><td>"+t.subTotal+"</td></tr><tr><td><strong>Metodo de pago : </strong></td><td>"+t.metodo_de_pago+"</td></tr><tr><td><strong>Moneda : </strong></td><td>"+t.moneda+"</td></tr></tbody></table></div></div>"),$("#infoParametrizacionModal").modal()}})},getAsignarCuentaImpuestos:function(t){if(0!=$("#id_cuenta_contable_im").val()&&0!=$("#id_cuenta_contable_imf").val()){var a={id_cuenta:$("#id_cuenta_contable_im").val(),id_cuenta_fiscal:$("#id_cuenta_contable_imf").val(),id:t};$.ajax({data:a,url:"/api_cont/asignar_cuenta_impuestos",type:"POST",dataType:"json",success:function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:"/api_cont/parametrizaciones/impuestos/"+$("#id_empresa_data").val(),type:"GET",dataType:"json",success:function(t){$("#contImpuestos").html(""),$("#contImpuestos").append(t.length),_g.dao.getTablaImpuestos(t)}})}})}else _gen.notificacion_min("Error","Seleccione una cuenta contable por favor",4)},getTablaIngresos:function(t){var a=$("#tblIngresos"),e=[{aTargets:[0],mData:"id_datatable"},{aTargets:[1],mData:"descripcion"},{aTargets:[2],mData:"cliente"},{aTargets:[3],mData:"importe"},{aTargets:[4],mData:"cuenta_contable"},{aTargets:[5],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-primary" onclick="_g.dao.getAsignarCuenta('+t.id_datatable+',2,0)"><i class="glyphicon glyphicon-floppy-saved"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getViewModal('+t.id_datatable+',2)"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;<a class="btn btn-sm btn-warning" onclick="_g.dao.getAsignarDispercion('+t.id_datatable+',2,0)"><i class="glyphicon glyphicon-refresh"></i></a>&nbsp;'}}];_gen.setDataTable(a,e,t)},getTablaEgresos:function(t){var a=$("#tblEgresos"),e=[{aTargets:[0],mData:"id_datatable"},{aTargets:[1],mData:"descripcion"},{aTargets:[2],mData:"proveedor"},{aTargets:[3],mData:"importe"},{aTargets:[4],mData:null,mRender:function(t){return"IVA 16"==t.tasa_iva?'<span class="center-block padding-5 label label-success">'+t.tasa_iva+"</span>":"IVA 0"==t.tasa_iva?'<span class="center-block padding-5 label label-primary">'+t.tasa_iva+"</span>":"Excento"==t.tasa_iva?'<span class="center-block padding-5 label label-warning">'+t.tasa_iva+"</span>":"NA"==t.tasa_iva?'<span class="center-block padding-5 label label-danger">'+t.tasa_iva+"</span>":void 0}},{aTargets:[5],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-default" onclick="_g.dao.getTasa('+t.id_datatable+', 1)"><i class="glyphicon glyphicon-refresh"></i></a>&nbsp;<a class="btn btn-sm btn-primary" onclick="_g.dao.getAsignarCuenta('+t.id_datatable+',3,0)"><i class="glyphicon glyphicon-floppy-saved"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getViewModal('+t.id_datatable+',3)"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;<a class="btn btn-sm btn-warning" onclick="_g.dao.getAsignarDispercion('+t.id_datatable+',3,0)"><i class="glyphicon glyphicon-refresh"></i></a>&nbsp;'}}];_gen.setDataTable(a,e,t)},getTasa:function(t,a){var e={},o="";1==a&&(e={id_concepto:t,tasa_iva:$("#tasa_iva").val()},o="/api_cont/parametrizaciones/egresos/"+$("#id_empresa_data").val()),2==a&&(e={id_concepto:t,tasa_iva:$("#tasa_iva_ncf").val()},o="/api_cont/parametrizaciones/ncf/"+$("#id_empresa_data").val()),$.ajax({url:"/api_cont/concepto_nueva_tasa",data:e,type:"POST",dataType:"json",success:function(t){_gen.notificacion_min("Exito","Se guardo correctamente",1)}}).done(function(t){$.ajax({url:o,type:"GET",dataType:"json",success:function(t){1==a&&_g.dao.getTablaEgresos(t),2==a&&_g.dao.getTablaNCF(t)}})})},getTablaNCC:function(t){var a=$("#tblNCC"),e=[{aTargets:[0],mData:"id_datatable"},{aTargets:[1],mData:"descripcion"},{aTargets:[2],mData:"cliente"},{aTargets:[3],mData:"importe"},{aTargets:[4],mData:"cuenta_contable"},{aTargets:[5],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-primary" onclick="_g.dao.getAsignarCuenta('+t.id_datatable+',4,0)"><i class="glyphicon glyphicon-floppy-saved"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getViewModal('+t.id_datatable+',4)"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;'}}];_gen.setDataTable(a,e,t)},getTablaNCF:function(t){var a=$("#tblNCF"),e=[{aTargets:[0],mData:"id_datatable"},{aTargets:[1],mData:"descripcion"},{aTargets:[2],mData:"proveedor"},{aTargets:[3],mData:"importe"},{aTargets:[4],mData:null,mRender:function(t){return"IVA 16"==t.tasa_iva?'<span class="center-block padding-5 label label-success">'+t.tasa_iva+"</span>":"IVA 0"==t.tasa_iva?'<span class="center-block padding-5 label label-primary">'+t.tasa_iva+"</span>":"Excento"==t.tasa_iva?'<span class="center-block padding-5 label label-warning">'+t.tasa_iva+"</span>":"NA"==t.tasa_iva?'<span class="center-block padding-5 label label-danger">'+t.tasa_iva+"</span>":void 0}},{aTargets:[5],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-default" onclick="_g.dao.getTasa('+t.id_datatable+', 2)"><i class="glyphicon glyphicon-refresh"></i></a>&nbsp;<a class="btn btn-sm btn-primary" onclick="_g.dao.getAsignarCuenta('+t.id_datatable+',5,0)"><i class="glyphicon glyphicon-floppy-saved"></i></a>&nbsp;<a class="btn btn-sm btn-success" onclick="_g.dao.getViewModal('+t.id_datatable+',5)"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;'}}];_gen.setDataTable(a,e,t)},getTablaNomina:function(t){var a=$("#tblNomina");$.each(t,function(a){t[a].departamento_numero='<h6><span class="label label-success">'+t[a].departamento_numero+"</span></h6>"});var e=[{aTargets:[0],mData:"id_nomina_pd"},{aTargets:[1],mData:"concepto"},{aTargets:[2],mData:"departamento_numero"},{aTargets:[3],mData:"tipo"},{aTargets:[4],mData:"tipo_clave"},{aTargets:[5],mData:"cuenta_contable"},{aTargets:[6],mData:null,mRender:function(t){if("Deduccion"==t.tipo)var a=1;if("Percepcion"==t.tipo)var a=2;var e=t.tipo_clave;return'<a class="btn btn-sm btn-primary" onclick="_g.dao.getAsignarCuentaNomina('+t.id_nomina_pd+",'"+e+"',"+a+')"><i class="glyphicon glyphicon-floppy-saved"></i></a>&nbsp;'}}];_gen.setTableNE(a,e,t)},getConceptosCuentas:function(t){var a=$("#tbAsignados"),e=[{aTargets:[0],mData:"cuenta"},{aTargets:[1],mData:"monto"},{aTargets:[2],mData:null,mRender:function(t){return 0!=t.monto?'<a class="btn btn-sm btn-success" onclick="_g.dao.getCancelarDispercion('+t.id+","+t.id_xml_concepto+')"><i class="glyphicon glyphicon-list-alt"></i></a>&nbsp;':""}}];_gen.setTableNE(a,e,t),$("#tbAsignados").show("slow")},getDispercionClientes:function(t){var a=$("#tblDispercionClientes"),e=[{aTargets:[0],mData:"descripcion"},{aTargets:[1],mData:"cliente"},{aTargets:[2],mData:"importe"},{aTargets:[3],mData:"anticipo_concepto"},{aTargets:[4],mData:"saldo_concepto"},{aTargets:[5],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-success" id="btnIngresos-'+t.id_datatable+'" onclick="_g.dao.getOperacionesIngresos('+t.id_datatable+","+t.importe+","+t.saldo_concepto+')"><i class="glyphicon glyphicon-list-alt"></i></a>&nbsp;'}}];_gen.setTableNE(a,e,t)},getDispercionProveedores:function(t){var a=$("#tblDispercionProveedores"),e=[{aTargets:[0],mData:"descripcion"},{aTargets:[1],mData:"proveedor"},{aTargets:[2],mData:"importe"},{aTargets:[3],mData:"anticipo_concepto"},{aTargets:[4],mData:"saldo_concepto"},{aTargets:[5],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-success" id="btnEgresos-'+t.id_datatable+'" onclick="_g.dao.getOperacionesEgresos('+t.id_datatable+","+t.importe+","+t.saldo_concepto+')"><i class="glyphicon glyphicon-list-alt"></i></a>&nbsp;';
}}];_gen.setTableNE(a,e,t)},getDispercionNomina:function(t){var a=$("#tblDispercionNomina"),e=[{aTargets:[0],mData:"empleado"},{aTargets:[1],mData:"Departamento"},{aTargets:[2],mData:null,mRender:function(t){return'<a class="btn btn-sm btn-success" id="btnNominaDispercion-'+t.id_nomina+'" onclick="_g.dao.getCambioDepartamento('+t.id_nomina+')"><i class="glyphicon glyphicon-list-alt"></i></a>&nbsp;'}}];_gen.setTableNE(a,e,t)},getDispercionNominaTotales:function(t){var a=$("#tbDepartamentosNomina"),e=[{aTargets:[0],mData:"Departamento"},{aTargets:[1],mData:"numero"}];_gen.setTableNE(a,e,t)},getAsignarCuentaNomina:function(t,a,e){if("017"==a&&"2"==e)if(0!=$("#id_cuenta_contable_nomina").val()&&0!=$("#id_cuenta_contable_nomina_excepcion").val()){var o={id_cuenta:$("#id_cuenta_contable_nomina").val(),id_cuenta_excepcion:$("#id_cuenta_contable_nomina_excepcion").val(),id:t};$.ajax({data:o,url:"/api_cont/asignar_cuenta_nomina",type:"POST",dataType:"json",success:function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:"/api_cont/parametrizaciones/nomina/"+$("#id_empresa_data").val(),type:"GET",dataType:"json",success:function(t){$("#contNomina").html(""),$("#contNomina").append(t.length),_g.dao.getTablaNomina(t)}})}})}else _gen.notificacion_min("Error","Seleccione una cuenta contable y una adicional por favor",4);else if("002"==a&&"1"==e)if(0!=$("#id_cuenta_contable_nomina").val()&&0!=$("#id_cuenta_contable_nomina_excepcion").val()){var o={id_cuenta:$("#id_cuenta_contable_nomina").val(),id_cuenta_excepcion:$("#id_cuenta_contable_nomina_excepcion").val(),id:t};$.ajax({data:o,url:"/api_cont/asignar_cuenta_nomina",type:"POST",dataType:"json",success:function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:"/api_cont/parametrizaciones/nomina/"+$("#id_empresa_data").val(),type:"GET",dataType:"json",success:function(t){$("#contNomina").html(""),$("#contNomina").append(t.length),_g.dao.getTablaNomina(t)}})}})}else _gen.notificacion_min("Error","Seleccione una cuenta contable y una adicional por favor",4);else if(0!=$("#id_cuenta_contable_nomina").val()){var o={id_cuenta:$("#id_cuenta_contable_nomina").val(),id_cuenta_excepcion:"0",id:t};$.ajax({data:o,url:"/api_cont/asignar_cuenta_nomina",type:"POST",dataType:"json",success:function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:"/api_cont/parametrizaciones/nomina/"+$("#id_empresa_data").val(),type:"GET",dataType:"json",success:function(t){$("#contNomina").html(""),$("#contNomina").append(t.length),_g.dao.getTablaNomina(t)}})}})}else _gen.notificacion_min("Error","Seleccione una cuenta contable por favor",4)},getAsignarDispercion:function(t,a,e){if(0==e&&(url_route="/api_cont/asignar_dispercion"),1==e&&(url_route="/api_cont/asignar_dispercion_multiple"),2==a){var o={id:t};url_table="/api_cont/parametrizaciones/ingresos/"}if(3==a){var o={id:t,no_deducible:$("#no_deducible").val(),IVAAcreIdent:$("#IVAAcreIdentE").val(),IvaAcreNOIdent:$("#IvaAcreNOIdentE").val(),IVAAcreExento:$("#IVAAcreExentoE").val()};url_table="/api_cont/parametrizaciones/egresos/"}$.ajax({data:o,url:url_route,type:"POST",dataType:"json"}).done(function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:url_table+$("#id_empresa_data").val(),type:"GET",dataType:"json"}).done(function(t){$(".success").removeClass("success"),selectedRows=[],2==a&&($("#contIngresos").html(""),$("#contIngresos").append(t.length),_g.dao.getTablaIngresos(t)),3==a&&($("#contEgresos").html(""),$("#contEgresos").append(t.length),_g.dao.getTablaEgresos(t)),4==a&&($("#contNCC").html(""),$("#contNCC").append(t.length),_g.dao.getTablaNCC(t)),5==a&&($("#contNCF").html(""),$("#contNCF").append(t.length),_g.dao.getTablaNCF(t))})})},getAsignarDispercionNomina:function(t){if(0!=t){var a={id:t};$.ajax({data:a,url:"/api_cont/asignar_dispercion_nomina",type:"POST",dataType:"json",success:function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:"/api_cont/parametrizaciones/nomina/"+$("#id_empresa_data").val(),type:"GET",dataType:"json",success:function(t){$("#contNomina").html(""),$("#contNomina").append(t.length),_g.dao.getTablaNomina(t)}})}})}else _gen.notificacion_min("Error","Seleccione un registro",4)},getCambioDepartamento:function(t){if(0!=t&&0!=$("#id_departamento_nomina").val()){var a={id:t,Departamento:$("#id_departamento_nomina").val()};$.ajax({data:a,url:"/api_cont/actualizar_departamento",type:"POST",dataType:"json",success:function(t){_g.dao.getTablaDispercionNominaTotales(),_g.dao.getTablaDispercionNomina(),_g.listas.getDepartamentoNomina()}})}else _gen.notificacion_min("Error","Seleccione un departamento",4)},getAsignarCuenta:function(t,a,e){if(0==e&&(url_route="/api_cont/asignar_cuenta"),1==e&&(url_route="/api_cont/asignar_cuenta_multiple"),2==a&&(ElementCC=$("#id_cuenta_contable_i"),url_table="/api_cont/parametrizaciones/ingresos/"),3==a){ElementCC=$("#id_cuenta_contable_e"),url_table="/api_cont/parametrizaciones/egresos/";var o={id_cuenta:ElementCC.val(),id:t,no_deducible:$("#no_deducible").val(),IVAAcreIdent:$("#IVAAcreIdentE").val(),IvaAcreNOIdent:$("#IvaAcreNOIdentE").val(),IVAAcreExento:$("#IVAAcreExentoE").val()}}if(4==a&&(ElementCC=$("#id_cuenta_contable_ncc"),url_table="/api_cont/parametrizaciones/ncc/"),5==a){ElementCC=$("#id_cuenta_contable_ncf"),url_table="/api_cont/parametrizaciones/ncf/";var o={id_cuenta:ElementCC.val(),id:t,IVAAcreIdent:$("#IVAAcreIdentNCF").val(),IvaAcreNOIdent:$("#IvaAcreNOIdentNCF").val(),IVAAcreExento:$("#IVAAcreExentoNCF").val(),id_empresa:$("#id_empresa_data").val()}}if(0!=ElementCC.val()){if(2==a||4==a)var o={id_cuenta:ElementCC.val(),id:t,id_empresa:$("#id_empresa_data").val()};$.ajax({data:o,url:url_route,type:"POST",dataType:"json"}).done(function(t){1!=localStorage.EditarParametrizacion&&"true"!=localStorage.EditarParametrizacion||_g.dao.getParametrizacionModificar(),0!=localStorage.EditarParametrizacion&&"false"!=localStorage.EditarParametrizacion||$.ajax({url:url_table+$("#id_empresa_data").val(),type:"GET",dataType:"json"}).done(function(t){$(".success").removeClass("success"),selectedRows=[],2==a&&($("#contIngresos").html(""),$("#contIngresos").append(t.length),_g.dao.getTablaIngresos(t)),3==a&&($("#contEgresos").html(""),$("#contEgresos").append(t.length),_g.dao.getTablaEgresos(t)),4==a&&($("#contNCC").html(""),$("#contNCC").append(t.length),_g.dao.getTablaNCC(t)),5==a&&($("#contNCF").html(""),$("#contNCF").append(t.length),_g.dao.getTablaNCF(t))})})}else _gen.notificacion_min("Error","Seleccione una cuenta contable por favor",4)},getViewModal:function(t,a){2==a&&(ruta="/api_cont/consulta/ingresos"),3==a&&(ruta="/api_cont/consulta/egresos"),4==a&&(ruta="/api_cont/consulta/ncc"),5==a&&(ruta="/api_cont/consulta/ncf");var e={id_empresa:$("#id_empresa").val(),id:t};$.ajax({url:ruta,type:"POST",data:e,dataType:"json"}).done(function(t){$("#contentParametrizacionModal").html(""),$("#contentParametrizacionModal").append('<div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="inf_xml_uuid"><table class="table table-bordered"><tbody><tr><td><strong>UUID :</strong></td><td id="plz_uuid">'+t.uuid+'</td></tr></tbody></table></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="inf_xml_one"><table class="table table-bordered"><tbody id="plz_data1"><tr><td><strong>Tipo Comprobante : </strong></td><td>'+t.origen+"</td></tr><tr><td><strong>Total XML : </strong></td><td>"+t.total+"</td></tr><tr><td><strong>SubTotal XML : </strong></td><td>"+t.subTotal+"</td></tr><tr><td><strong>Metodo de pago : </strong></td><td>"+t.metodo_de_pago+"</td></tr><tr><td><strong>Moneda : </strong></td><td>"+t.moneda+"</td></tr></tbody></table></div></div>"),$("#infoParametrizacionModal").modal()})},getTablaXMLError:function(){$.ajax({url:"/api_cont/archivos_xml_error/"+$("#id_empresa_data").val(),type:"GET",dataType:"json"}).done(function(t){var a=t,e=$("#tblError");$("#contError").append(t.length);var o=[{aTargets:[0],mData:"id"},{aTargets:[1],mData:"nombre_archivo"},{aTargets:[2],mData:"uuid"},{aTargets:[3],mData:"observaciones"}];_gen.setTableNE(e,o,a)})},getTablaDispercionClientes:function(){$.ajax({url:"/api_cont/dispercion/ingresos/"+$("#id_empresa").val(),type:"GET",dataType:"json"}).done(function(t){_g.dao.getDispercionClientes(t)}).fail(function(t){_gen.notificacion_min("Error","La operaci&oacute;n no se realiz&oacute; correctamente","gritter-error")})},getTablaDispercionProveedores:function(){$.ajax({url:"/api_cont/dispercion/egresos/"+$("#id_empresa").val(),type:"GET",dataType:"json"}).done(function(t){_g.dao.getDispercionProveedores(t)}).fail(function(t){_gen.notificacion_min("Error","La operaci&oacute;n no se realiz&oacute; correctamente","gritter-error")})},getTablaDispercionNomina:function(){$.ajax({url:"/api_cont/dispercion/nomina/"+$("#id_empresa").val(),type:"GET",dataType:"json"}).done(function(t){_g.dao.getDispercionNomina(t)}).fail(function(t){_gen.notificacion_min("Error","La operaci&oacute;n no se realiz&oacute; correctamente","gritter-error")})},getTablaDispercionNominaTotales:function(){$.ajax({url:"/api_cont/dispercion/nomina_totales/"+$("#id_empresa").val(),type:"GET",dataType:"json"}).done(function(t){_g.dao.getDispercionNominaTotales(t)}).fail(function(t){_gen.notificacion_min("Error","La operaci&oacute;n no se realiz&oacute; correctamente","gritter-error")})},getOperacionesIngresos:function(t,a,e){_g.listas.getCatCuentasConceptosId(t,$("#id_cuentas_conceptos_clientes")),localStorage.id_dispercion_ingresos=t,$("#id_concepto_clientes").val(t),localStorage.cantidad_oclientes=e,$("#operaciones_conceptos_clientes").show("slow"),$("#operaciones_clientes").val(e).focus()},getOperacionesEgresos:function(t,a,e){_g.listas.getCatCuentasConceptosId(t,$("#id_cuentas_conceptos_proveedores")),localStorage.id_dispercion_egresos=t,$("#id_concepto_proveedores").val(t),localStorage.cantidad_oproveedores=e,$("#operaciones_conceptos_proveedores").show("slow"),$("#operaciones_proveedores").val(e).focus()},getCancelarDispercion:function(t,a,e){$.ajax({url:"/api_cont/cancelar_dispercion_conceptos/"+t+"/"+a,type:"GET",dataType:"json"}).done(function(t){_g.dao.getConceptosCuentas(t),_g.dao.getTablaDispercionClientes(),_g.dao.getTablaDispercionProveedores(),""!=$("#id_concepto_clientes").val()&&_g.listas.getCatCuentasConceptosId($("#id_concepto_clientes").val(),$("#id_cuentas_conceptos_clientes")),""!=$("#id_concepto_proveedores").val()&&_g.listas.getCatCuentasConceptosId($("#id_concepto_proveedores").val(),$("#id_cuentas_conceptos_proveedores")),_gen.notificacion_min("Exito","Se guardo correctamente",1)})},getOperacionesClientes:function(){if(parseFloat($("#operaciones_clientes").val())>localStorage.cantidad_oclientes)_gen.notificacion_min("Error","La cantidad es mayor",4);else if(0!=$("#id_cuentas_conceptos_clientes").val()||""!=$("#id_cuentas_conceptos_clientes").val()){var t=$("#id_cuentas_conceptos_clientes").val();if($("#id_cuentas_conceptos_clientes").val(0),""!=$("#id_concepto_clientes").val()&&""!=$("#operaciones_clientes").val()){var a={id_cuenta:t,monto:$("#operaciones_clientes").val()};$.ajax({data:a,url:"/api_cont/dispercion_conceptos/"+$("#id_concepto_clientes").val(),type:"PUT",dataType:"json"}).done(function(t){_g.dao.getConceptosCuentas(t),_g.listas.getCatCuentasConceptosId($("#id_concepto_clientes").val(),$("#id_cuentas_conceptos_clientes")),_g.dao.getTablaDispercionClientes(),_gen.notificacion_min("Exito","Se guardo correctamente",1)}),localStorage.cantidad_oclientes=parseFloat(localStorage.cantidad_oclientes)-parseFloat($("#operaciones_clientes").val()),$("#operaciones_clientes").val(localStorage.cantidad_oclientes)}$("#operaciones_clientes").val()<=0&&(_g.listas.getConceptosDispercion($("#id_empresa").val(),$("#id_concepto_dispercion")),$("#operaciones_conceptos_clientes").hide(),$("#operaciones_clientes").val("0"),localStorage.id_dispercion_ingresos=0,localStorage.cantidad_oclientes=0)}else _gen.notificacion_min("Error","Seleccione una cuenta del concepto",4)},getOperacionesProveedores:function(){if(parseFloat($("#operaciones_proveedores").val())>localStorage.cantidad_oproveedores)_gen.notificacion_min("Error","La cantidad es mayor",4);else if(0!=$("#id_cuentas_conceptos_proveedores").val()||""!=$("#id_cuentas_conceptos_proveedores").val()){var t=$("#id_cuentas_conceptos_proveedores").val();if($("#id_cuentas_conceptos_proveedores").val(0),""!=$("#id_concepto_proveedores").val()&&""!=$("#operaciones_proveedores").val()){var a={id_cuenta:t,monto:$("#operaciones_proveedores").val()};$.ajax({data:a,url:"/api_cont/dispercion_conceptos/"+$("#id_concepto_proveedores").val(),type:"PUT",dataType:"json"}).done(function(t){_g.dao.getConceptosCuentas(t),_g.listas.getCatCuentasConceptosId($("#id_concepto_proveedores").val(),$("#id_cuentas_conceptos_proveedores")),_g.dao.getTablaDispercionProveedores(),_gen.notificacion_min("Exito","Se guardo correctamente",1)}),localStorage.cantidad_oproveedores=parseFloat(localStorage.cantidad_oproveedores)-parseFloat($("#operaciones_proveedores").val()),$("#operaciones_proveedores").val(localStorage.cantidad_oproveedores)}$("#operaciones_proveedores").val()<=0&&(_g.listas.getConceptosDispercionE($("#id_empresa").val(),$("#id_concepto_dispercion")),$("#operaciones_conceptos_proveedores").hide(),$("#operaciones_proveedores").val("0"),localStorage.id_dispercion_ingresos=0,localStorage.cantidad_oproveedores=0)}else _gen.notificacion_min("Error","Seleccione una cuenta del concepto",4)}},pageSetUp();var pagefunction=function(){localStorage.EditarParametrizacion=!1,localStorage.id_dispercion_ingresos=0,localStorage.cantidad_operacion_clientes=0,_g.listas.getEmpresas(),$("#id_sucursal").select2(),$("#desde, #hasta").datepicker({dateFormat:"yy-mm-dd",language:"es"}),Dropzone.autoDiscover=!1,$("#mydropzone").dropzone({init:function(){myDropzone=this,this.on("addedfile",function(t){}),this.on("complete",function(t){0===this.getUploadingFiles().length&&0===this.getQueuedFiles().length&&($("#cargandoInfo").show(),$("#tblInconsistencias").dataTable(),_g.listas.getCatMonedas(),_g.listas.getCatCuentasContableParametrizacion($("#id_empresa_data").val()),_g.dao.getParametrizacion()),myDropzone.removeFile(t)})},acceptedFiles:".xml,.XML",autoProcessQueue:!0,addRemoveLinks:!0,maxFilesize:5,uploadMultiple:!1,dictDefaultMessage:'<span class="text-center"><span class="font-lg visible-xs-block visible-sm-block visible-lg-block"><span class="font-lg"><i class="fa fa-caret-right text-danger"></i> Seleccione los archivos <span class="font-xs">xml</span></span><span>&nbsp&nbsp<h4 class="display-inline"> (Or Click)</h4></span>',dictResponseError:"Error uploading file!"});var t=$(".wizard").wizard();t.on("change",function(t,a){return 1==a.step?(selectedRows=[],!0):(2==a.step&&(selectedRows=[]),3==a.step&&($(".success").removeClass("success"),selectedRows=[]),4==a.step&&($(".success").removeClass("success"),selectedRows=[]),5==a.step&&($(".success").removeClass("success"),selectedRows=[]),6==a.step&&($(".success").removeClass("success"),selectedRows=[]),void(7==a.step&&(selectedRows=[])))}).on("finished",function(t,a){window.location.reload()}).on("stepclick",function(t){return!1}),$("#btnCargar").click(function(t){t.preventDefault(),0!=$("#id_empresa_data").val()?($("#cargarXML").show("slow"),$("#GroupCancelar").show("slow"),$("#tbl11").hide(),$("#GroupIniciales").hide(),$("#group-filter").hide()):_gen.notificacion_min("Error","Seleccione una empresa por favor",4)}),$("#SelectAllIngresosI").on("click",function(){var t=$("#tblIngresos").dataTable()._("tr",{filter:"applied"});if(0!=t.length){var a=[];jQuery.each(t,function(e,o){a.push(t[e].id_datatable)}),_g.dao.getAsignarCuenta(a,2,1)}else _gen.notificacion_min("Error","Ningun concepto para asignar cuenta contable",4)}),$("#SelectAllIngresosE").on("click",function(){var t=$("#tblEgresos").dataTable()._("tr",{filter:"applied"});if(0!=t.length){var a=[];jQuery.each(t,function(e,o){a.push(t[e].id_datatable)}),_g.dao.getAsignarCuenta(a,3,1)}else _gen.notificacion_min("Error","Ningun concepto para asignar cuenta contable",4)}),$("#SelectAllIngresosNCF").on("click",function(){var t=$("#tblNCF").dataTable()._("tr",{filter:"applied"});if(0!=t.length){var a=[];jQuery.each(t,function(e,o){a.push(t[e].id_datatable)}),_g.dao.getAsignarCuenta(a,5,1)}else _gen.notificacion_min("Error","Ningun concepto para asignar cuenta contable",4)}),$("#SelectAllIngresosNCC").on("click",function(){var t=$("#tblNCC").dataTable()._("tr",{filter:"applied"});if(0!=t.length){var a=[];jQuery.each(t,function(e,o){a.push(t[e].id_datatable)}),_g.dao.getAsignarCuenta(a,4,1)}else _gen.notificacion_min("Error","Ningun concepto para asignar cuenta contable",4)}),$("#btnImprimir").click(function(t){t.preventDefault(),_gen.notificacion_min("Error","Formato de impresion por definir",4)}),$("#btnProcesar").on("click",function(){$(this).off(event),$("#WdtDropzone").hide(),$("#cargandoInfo").show(),$("#tblInconsistencias").dataTable(),_g.listas.getCatMonedas(),_g.listas.getCatCuentasContableParametrizacion($("#id_empresa_data").val()),_g.dao.getParametrizacion()}),$("#btnConsultar").click(function(t){t.preventDefault(),_g.dao.getXMLAvanzada()}),$("#btnNuevaDepartamento").click(function(t){t.preventDefault(),$("#NuevoDepartamentoNomina").modal("show")}),$("#btnAgregarDepartamento").click(function(t){t.preventDefault(),""!=$("#departamento").val()?$.post("/api_cont/departamento_nomina",{departamento:$("#departamento").val()}).done(function(t){_g.listas.getDepartamentoNomina(),_gen.notificacion_min("&Eacute;xito","La operaci&oacute;n se realiz&oacute; exitosamente",1),$("#NuevoDepartamentoNomina").modal("hide")}).fail(function(t){_g.listas.getDepartamentoNomina(),_gen.notificacion_min("Error",t.responseText,4),$("#NuevoDepartamentoNomina").modal("hide")}):_gen.notificacion_min("Error","Es necesario llenar los datos",4)}),$("#btnEstructuraAdecuada").click(function(t){t.preventDefault(),$.get("/api_cont/xml_dispercion_nomina/"+$("#id_empresa").val()).done(function(t){_g.dao.getTablaDispercionNominaTotales(),_g.dao.getTablaDispercionNomina(),_g.listas.getDepartamentoNomina(),_gen.notificacion_min("&Eacute;xito","La operaci&oacute;n se realiz&oacute; exitosamente",1)}).fail(function(t){_g.dao.getTablaDispercionNominaTotales(),_g.dao.getTablaDispercionNomina(),_g.listas.getDepartamentoNomina(),_gen.notificacion_min("Error",t.responseText,4)})}),$("#btnDispercion").click(function(t){t.preventDefault(),_g.dao.getTablaDispercionClientes(),_g.dao.getTablaDispercionProveedores(),_g.listas.getConceptosDispercion($("#id_empresa").val(),$("#id_concepto_dispercion")),_g.listas.getCatCuentasContableCuztom($("#id_empresa_data").val(),$("#id_cuenta_contable_dispercion"))}),$("#TabHNomina").click(function(t){t.preventDefault(),_g.dao.getTablaDispercionNominaTotales(),_g.dao.getTablaDispercionNomina(),_g.listas.getDepartamentoNomina(),$("#HeaderNomina").show("slow"),$("#HeaderClientesProveedores").hide()}),$("#TabHClientes, #TabHProveedores").click(function(t){t.preventDefault(),$("#HeaderNomina").hide(),$("#HeaderClientesProveedores").show("slow")}),$("#btnAsignarCuentaI").click(function(t){t.preventDefault(),_g.dao.getAsignarCuenta(selectedRows,2,1)}),$("#btnAsignarCuentaE").click(function(t){t.preventDefault(),_g.dao.getAsignarCuenta(selectedRows,3,1)}),$("#btnAsignarCuentaNCF").click(function(t){t.preventDefault(),_g.dao.getAsignarCuenta(selectedRows,5,1)}),$("#btnAsignarCuentaNCC").click(function(t){t.preventDefault(),_g.dao.getAsignarCuenta(selectedRows,4,1)}),$("#operaciones_clientes").keypress(function(t){13==t.which&&(t.preventDefault(),0!=$("#id_cuentas_conceptos_clientes").val()?_g.dao.getOperacionesClientes():_gen.notificacion_min("Error","Es necesario seleccionar una cuenta del concepto",4))}),$("#operaciones_proveedores").keypress(function(t){13==t.which&&(t.preventDefault(),0!=$("#id_cuentas_conceptos_proveedores").val()?_g.dao.getOperacionesProveedores():_gen.notificacion_min("Error","Es necesario seleccionar una cuenta del concepto",4))}),$("#btnDispercionI").click(function(t){t.preventDefault(),_g.dao.getAsignarDispercion(selectedRows,2,1)}),$("#btnDispercionE").click(function(t){t.preventDefault(),_g.dao.getAsignarDispercion(selectedRows,3,1)}),$("#btnCuentaConcepto").click(function(t){t.preventDefault();var a={id_xml_concepto:$("#id_concepto_dispercion").val(),id_cuenta:$("#id_cuenta_contable_dispercion").val()};0!=$("#id_cuenta_contable_dispercion").val()&&0!=$("#id_concepto_dispercion").val()?($("#id_cuenta_contable_dispercion").val(0),$.ajax({data:a,url:"/api_cont/dispercion_conceptos",type:"POST",dataType:"json"}).done(function(t){$.ajax({url:"/api_cont/dispercion/cuentas_concepto/"+$("#id_concepto_dispercion").val(),type:"GET",dataType:"json"}).done(function(t){_g.dao.getConceptosCuentas(t)}),_g.listas.getCatCuentasContableId($("#id_concepto_dispercion").val(),$("#id_cuenta_contable_dispercion")),_gen.notificacion_min("Exito","Se guardo correctamente",1)})):_gen.notificacion_min("Error","Es necesario seleccionar un concepto y una cuenta contable",4)}),$("#id_concepto_dispercion").change(function(t){_g.listas.getCatCuentasContableId($("#id_concepto_dispercion").val(),$("#id_cuenta_contable_dispercion")),$.ajax({url:"/api_cont/dispercion/cuentas_concepto/"+$("#id_concepto_dispercion").val(),type:"GET",dataType:"json"}).done(function(t){_g.dao.getConceptosCuentas(t)})}),$("#btnCancelar").click(function(){_g.listas.getEmpresas(),$("#cargarXML, #GroupCancelar, #WdtParametrizacion").hide(),$("#GroupIniciales, #WdtDropzone, #group-filter, #tbl11").show("slow"),$("#id_sucursal").select2()}),$("#id_empresa").change(function(t){var a=$("#id_empresa").val();$("#id_empresa_data").val(a),_g.dao.getValidParametrizacion(),_g.listas.getEmpresasSucursales(),_g.dao.getXMLAvanzada()}),$("#id_sucursal").change(function(t){var a=$("#id_sucursal").val();$("#id_sucursal_data").val(a)}),$("#no_deducible").change(function(t){$("#no_deducible").is(":checked")?$("#no_deducible").val("1"):$("#no_deducible").val("0")}),$("#IVAAcreIdentE").change(function(t){$("#IVAAcreIdentE").is(":checked")?$("#IVAAcreIdentE").val("1"):$("#IVAAcreIdentE").val("0")}),$("#IvaAcreNOIdentE").change(function(t){$("#IvaAcreNOIdentE").is(":checked")?$("#IvaAcreNOIdentE").val("1"):$("#IvaAcreNOIdentE").val("0")}),$("#IVAAcreExentoE").change(function(t){$("#IVAAcreExentoE").is(":checked")?$("#IVAAcreExentoE").val("1"):$("#IVAAcreExentoE").val("0")})};pagefunction(),function(t){"use strict";function a(t,a){if(this.createTextRange){var e=this.createTextRange();e.collapse(!0),e.moveStart("character",t),e.moveEnd("character",a-t),e.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(t,a))}function e(t){var a=this.value.length;if(t="start"==t.toLowerCase()?"Start":"End",document.selection){var e,o,n,i=document.selection.createRange();return e=i.duplicate(),e.expand("textedit"),e.setEndPoint("EndToEnd",i),o=e.text.length-i.text.length,n=o+i.text.length,"Start"==t?o:n}return"undefined"!=typeof this["selection"+t]&&(a=this["selection"+t]),a}var o={codes:{46:127,188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};t.fn.number=function(n,i,s,r){r="undefined"==typeof r?",":r,s="undefined"==typeof s?".":s,i="undefined"==typeof i?0:i;var c="\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4),d=new RegExp("[^"+c+"0-9]","g"),l=new RegExp(c,"g");return n===!0?this.is("input:text")?this.on({"keydown.format":function(n){var c=t(this),d=c.data("numFormat"),l=n.keyCode?n.keyCode:n.which,p="",g=e.apply(this,["start"]),_=e.apply(this,["end"]),u="",m=!1;if(o.codes.hasOwnProperty(l)&&(l=o.codes[l]),!n.shiftKey&&l>=65&&l<=90?l+=32:!n.shiftKey&&l>=69&&l<=105?l-=48:n.shiftKey&&o.shifts.hasOwnProperty(l)&&(p=o.shifts[l]),""==p&&(p=String.fromCharCode(l)),8!=l&&45!=l&&127!=l&&p!=s&&!p.match(/[0-9]/)){var b=n.keyCode?n.keyCode:n.which;if(46==b||8==b||127==b||9==b||27==b||13==b||(65==b||82==b||80==b||83==b||70==b||72==b||66==b||74==b||84==b||90==b||61==b||173==b||48==b)&&(n.ctrlKey||n.metaKey)===!0||(86==b||67==b||88==b)&&(n.ctrlKey||n.metaKey)===!0||b>=35&&b<=39||b>=112&&b<=123)return;return n.preventDefault(),!1}if(0==g&&_==this.value.length?8==l?(g=_=1,this.value="",d.init=i>0?-1:0,d.c=i>0?-(i+1):0,a.apply(this,[0,0])):p==s?(g=_=1,this.value="0"+s+new Array(i+1).join("0"),d.init=i>0?1:0,d.c=i>0?-(i+1):0):45==l?(g=_=2,this.value="-0"+s+new Array(i+1).join("0"),d.init=i>0?1:0,d.c=i>0?-(i+1):0,a.apply(this,[2,2])):(d.init=i>0?-1:0,d.c=i>0?-i:0):d.c=_-this.value.length,d.isPartialSelection=g!=_,i>0&&p==s&&g==this.value.length-i-1)d.c++,d.init=Math.max(0,d.init),n.preventDefault(),m=this.value.length+d.c;else if(45!=l||0==g&&0!=this.value.indexOf("-"))if(p==s)d.init=Math.max(0,d.init),n.preventDefault();else if(i>0&&127==l&&g==this.value.length-i-1)n.preventDefault();else if(i>0&&8==l&&g==this.value.length-i)n.preventDefault(),d.c--,m=this.value.length+d.c;else if(i>0&&127==l&&g>this.value.length-i-1){if(""===this.value)return;"0"!=this.value.slice(g,g+1)&&(u=this.value.slice(0,g)+"0"+this.value.slice(g+1),c.val(u)),n.preventDefault(),m=this.value.length+d.c}else if(i>0&&8==l&&g>this.value.length-i){if(""===this.value)return;"0"!=this.value.slice(g-1,g)&&(u=this.value.slice(0,g-1)+"0"+this.value.slice(g),c.val(u)),n.preventDefault(),d.c--,m=this.value.length+d.c}else 127==l&&this.value.slice(g,g+1)==r?n.preventDefault():8==l&&this.value.slice(g-1,g)==r?(n.preventDefault(),d.c--,m=this.value.length+d.c):i>0&&g==_&&this.value.length>i+1&&g>this.value.length-i-1&&isFinite(+p)&&!n.metaKey&&!n.ctrlKey&&!n.altKey&&1===p.length&&(u=_===this.value.length?this.value.slice(0,g-1):this.value.slice(0,g)+this.value.slice(g+1),this.value=u,m=g);else n.preventDefault();m!==!1&&a.apply(this,[m,m]),c.data("numFormat",d)},"keyup.format":function(o){var n,s=t(this),r=s.data("numFormat"),c=o.keyCode?o.keyCode:o.which,d=e.apply(this,["start"]),l=e.apply(this,["end"]);0!==d||0!==l||189!==c&&109!==c||(s.val("-"+s.val()),d=1,r.c=1-this.value.length,r.init=1,s.data("numFormat",r),n=this.value.length+r.c,a.apply(this,[n,n])),""===this.value||(c<48||c>57)&&(c<96||c>105)&&8!==c&&46!==c&&110!==c||(s.val(s.val()),i>0&&(r.init<1?(d=this.value.length-i-(r.init<0?1:0),r.c=d-this.value.length,r.init=1,s.data("numFormat",r)):d>this.value.length-i&&8!=c&&(r.c++,s.data("numFormat",r))),46!=c||r.isPartialSelection||(r.c++,s.data("numFormat",r)),n=this.value.length+r.c,a.apply(this,[n,n]))},"paste.format":function(a){var e=t(this),o=a.originalEvent,n=null;return window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):o.clipboardData&&o.clipboardData.getData&&(n=o.clipboardData.getData("text/plain")),e.val(n),a.preventDefault(),!1}}).each(function(){var a=t(this).data("numFormat",{c:-(i+1),decimals:i,thousands_sep:r,dec_point:s,regex_dec_num:d,regex_dec:l,init:!!this.value.indexOf(".")});""!==this.value&&a.val(a.val())}):this.each(function(){var a=t(this),e=+a.text().replace(d,"").replace(l,".");a.number(isFinite(e)?+e:0,i,s,r)}):this.text(t.number.apply(window,arguments))};var n=null,i=null;t.isPlainObject(t.valHooks.text)?(t.isFunction(t.valHooks.text.get)&&(n=t.valHooks.text.get),t.isFunction(t.valHooks.text.set)&&(i=t.valHooks.text.set)):t.valHooks.text={},t.valHooks.text.get=function(a){var e,o=t(a),i=o.data("numFormat");return i?""===a.value?"":(e=+a.value.replace(i.regex_dec_num,"").replace(i.regex_dec,"."),(0===a.value.indexOf("-")?"-":"")+(isFinite(e)?e:0)):t.isFunction(n)?n(a):void 0},t.valHooks.text.set=function(a,e){var o=t(a),n=o.data("numFormat");if(n){var s=t.number(e,n.decimals,n.dec_point,n.thousands_sep);return t.isFunction(i)?i(a,s):a.value=s}return t.isFunction(i)?i(a,e):void 0},t.number=function(t,a,e,o){o="undefined"==typeof o?"1000"!==new Number(1e3).toLocaleString()?new Number(1e3).toLocaleString().charAt(1):"":o,e="undefined"==typeof e?new Number(.1).toLocaleString().charAt(1):e,a=isFinite(+a)?Math.abs(a):0;var n="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),i="\\u"+("0000"+o.charCodeAt(0).toString(16)).slice(-4);t=(t+"").replace(".",e).replace(new RegExp(i,"g"),"").replace(new RegExp(n,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var s=isFinite(+t)?+t:0,r="",c=function(t,a){return""+ +(Math.round((""+t).indexOf("e")>0?t:t+"e+"+a)+"e-"+a)};return r=(a?c(s,a):""+Math.round(s)).split("."),r[0].length>3&&(r[0]=r[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(r[1]||"").length<a&&(r[1]=r[1]||"",r[1]+=new Array(a-r[1].length+1).join("0")),r.join(e)}}(jQuery);