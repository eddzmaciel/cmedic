$(document).ready(function(){localStorage.removeItem("id_empresa"),$(".datepickerEs").datepicker({dateFormat:"yy-mm-dd",language:"es"})});var pagefunction=function(){_g.listas.getEmpresas(),$("#btnNuevo").click(function(){0!=$("#id_empresa").val()?window.location.href="/#contabilidad/poliza_manual/nuevo":_gen.notificacion_min("Error","Es necesario seleccionar una empresa",4)}),$("#btnConsultar").click(function(){0!=$("#id_empresa").val()?_g.dao.getPolizasBancos():_gen.notificacion_min("Error","Es necesario seleccionar una empresa",4)}),$("#id_empresa").change(function(a){_g.dao.getPolizasBancos(),_g.listas.getEmpresasSucursales(),localStorage.id_empresa=$("#id_empresa").val()})};_g.dao={getPolizasBancos:function(){var a={id_empresa:$("#id_empresa").val(),id_sucursal:$("#id_sucursal").val(),fecha_poliza:$("#fecha_poliza").val(),tipo_poliza:$("#tipo_poliza").val(),num_operacion:$("#num_operacion").val(),tipo_operacion:$("#tipo_operacion").val(),concepto_poliza:$("#concepto_poliza").val(),folio:$("#folio").val(),fecha_desde:$("#fecha_desde").val(),fecha_hasta:$("#fecha_hasta").val()};$.ajax({data:a,url:"/api_cont/polizas_manuales_avanzada",type:"POST",dataType:"json",success:function(a){var o=[];console.log(a),0!=a.length&&($.each(a,function(o){0!=a[o].movimientos_bancarios&&null!=a[o].movimientos_bancarios||(a[o].movimientos_bancarios='<a href="javascript:void(0);" readonly="true" class="btn btn-danger btn-circle"><i class="glyphicon glyphicon-remove"></i></a>'),"on"==a[o].movimientos_bancarios&&(a[o].movimientos_bancarios='<a href="javascript:void(0);" readonly="true" class="btn btn-success btn-circle"><i class="glyphicon glyphicon-ok"></i></a>')}),o=a);var e=$("#tblPolizasManuales"),n=[{aTargets:[0],mData:"tipo_poliza"},{aTargets:[1],mData:"fecha"},{aTargets:[2],mData:"poliza"},{aTargets:[3],mData:"concepto"},{aTargets:[4],mData:"tipo_documento"},{aTargets:[5],mData:"num_documento"},{aTargets:[6],mData:"movimientos_bancarios"},{aTargets:[7],mData:null,mRender:function(a){return'<a class="btn btn-sm btn-success" target="_blank" onclick="_g.dao.getModalPDF('+a.id+')"><i class="glyphicon glyphicon-eye-open"></i></a>&nbsp;'}}];_gen.setTableNE(e,n,o),$("#infoBancosEmpresas").show("slow")}})},getModalPDF:function(a){var o="/api_cont/reporte_poliza_manual/"+a;$("#PDFPreview").attr("src",o),$("#infoPreviewPDF").modal("show")}},pagefunction();